{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{533:function(t,s,n){\"use strict\";n.r(s);var a=n(30),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[n(\"p\",[t._v(\"修改 nginx.conf 部分配置\")]),t._v(\" \"),n(\"p\",[t._v(\"配置 http 转成 https\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"server {\\n        listen       80;\\n        server_name  www.zervan.cn;\\n        #rewrite ^(.*)$  https://$host$1 permanent;\\n        rewrite ^/(.*)$ http://www.zervan.cn/$1 permanent;\\n         }\\n\")])])]),n(\"p\",[t._v(\"配置 ssl 证书 给原有注释的 # HTTPS server 拷贝一份\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"# HTTPS server\\n#\\nserver {\\n    listen       443 ssl;\\n    server_name  www.zervan.cn;\\n\\n    ssl_certificate      /etc/nginx/ssl/zervan.cn.pem;\\n    ssl_certificate_key  /etc/nginx/ssl/zervan.cn.key;\\n\\n\\t\\tssl on;\\n    ssl_session_cache    shared:SSL:1m;\\n    ssl_session_timeout  5m;\\n\\n    ssl_ciphers  HIGH:!aNULL:!MD5;\\n    ssl_prefer_server_ciphers  on;\\n\\n    location / {\\n        root   html;\\n        index  index.html index.htm;\\n    }\\n\\n}\\n\\n\")])])]),n(\"p\",[t._v(\"sudo systemctl restart nginx\")]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"1、查看nginx安装目录\")])]),t._v(\" \"),n(\"p\",[t._v(\"输入命令\")]),t._v(\" \"),n(\"p\",[t._v(\"# ps -ef | grep nginx\")]),t._v(\" \"),n(\"p\",[t._v(\"返回结果包含安装目录\")]),t._v(\" \"),n(\"p\",[t._v(\"root   2662   1 0 07:12 ?    00:00:00 nginx: master process /usr/sbin/nginx\")]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"2、查看nginx.conf配置文件目录\")])]),t._v(\" \"),n(\"p\",[t._v(\"输入命令\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"# nginx -t\\n\\n返回结果包含配置文件目录\\n\")])])]),n(\"p\",[t._v(\"nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\")]),t._v(\" \"),n(\"p\",[t._v(\"nginx: configuration file /etc/nginx/nginx.conf test is successful\")]),t._v(\" \"),n(\"h4\",{attrs:{id:\"_4-编辑nginx配置文件-nginx-conf\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-编辑nginx配置文件-nginx-conf\"}},[t._v(\"#\")]),t._v(\" 4.编辑Nginx配置文件（nginx.conf）\")]),t._v(\" \"),n(\"p\",[t._v(\"编辑Nginx配置文件（nginx.conf），修改与证书相关的配置。\")]),t._v(\" \"),n(\"p\",[t._v(\"4.1 执行以下命令，打开配置文件。\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-javascript extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[n(\"code\",[t._v(\"vim \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"usr\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"local\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"nginx\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"conf\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"nginx\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"conf\\n\")])])]),n(\"p\",[t._v(\"复制\")]),t._v(\" \"),n(\"p\",[t._v(\"4.2 按i键进入编辑模式。\")]),t._v(\" \"),n(\"p\",[t._v(\"4.3 在配置文件中定位到HTTP协议代码片段（http{}），并在HTTP协议代码里面添加以下server配置（如果server配置已存在，按照以下注释内容修改相应配置即可）。 使用示例代码前，请注意替换以下内容： haiyong.site：替换成证书绑定的\"),n(\"a\",{attrs:{href:\"https://cloud.tencent.com/act/pro/domain-sales?from=10680\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"域名\"),n(\"OutboundLink\")],1),t._v(\"。 fullchain.pem：替换成步骤3中上传的证书文件的名称。 private.key：替换成步骤3中上传的证书私钥文件的名称。\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-javascript extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[n(\"code\",[t._v(\"#以下属性中，以ssl开头的属性表示与证书配置有关。\\nserver \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    listen \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"443\")]),t._v(\" ssl\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    #配置\"),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"HTTPS\")]),t._v(\"的默认访问端口为\"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"443\")]),t._v(\"。\\n    #如果未在此处配置\"),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"HTTPS\")]),t._v(\"的默认访问端口，可能会造成Nginx无法启动。\\n    #如果您使用Nginx \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.15\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\".0\")]),t._v(\"及以上版本，请使用listen \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"443\")]),t._v(\" ssl代替listen \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"443\")]),t._v(\"和ssl on。\\n    server_name haiyong\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"site\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    root html\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    index index\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"html index\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"htm\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    ssl_certificate cert\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"fullchain\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"pem\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"  \\n    ssl_certificate_key cert\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"private\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"key\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \\n    ssl_session_timeout 5m\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    ssl_ciphers \"),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"ECDHE\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"RSA\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"AES128\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"GCM\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"SHA256\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"ECDHE\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"ECDH\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"AES\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"HIGH\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"!\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"NULL\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"!\")]),t._v(\"aNULL\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"!\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"MD5\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"!\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"ADH\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"!\")]),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"RC4\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    #表示使用的加密套件的类型。\\n    ssl_protocols TLSv1\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),t._v(\" TLSv1\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"2\")]),t._v(\" TLSv1\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"3\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" #表示使用的\"),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"TLS\")]),t._v(\"协议的类型，您需要自行评估是否配置TLSv1\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),t._v(\"协议。\\n    ssl_prefer_server_ciphers on\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    location \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        root \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"var\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"www\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"html\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"  #Web网站程序存放目录。\\n        index index\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"html index\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"htm\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n      ssl_certificate      \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"etc\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"nginx\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"ssl\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"zervan\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"cn\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"pem\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    ssl_certificate_key  \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"etc\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"nginx\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"ssl\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"zervan\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"cn\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"key\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),n(\"p\",[t._v(\"复制\")]),t._v(\" \"),n(\"p\",[t._v(\"4.4 \"),n(\"strong\",[t._v(\"可选\")]),t._v(\"：设置HTTP请求自动跳转HTTPS。 如果您希望所有的HTTP访问自动跳转到HTTPS页面，则可以在需要跳转的HTTP站点下添加以下rewrite语句。\")]),t._v(\" \"),n(\"blockquote\",[n(\"p\",[t._v(\"注意：以下代码片段需要放置在 nginx.conf文件中 server{} 代码段后面，即设置HTTP请求自动跳转HTTPS后，nginx.conf 文件中会存在两个server {}代码段。\")])]),t._v(\" \"),n(\"div\",{staticClass:\"language-javascript extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[n(\"code\",[t._v(\"server \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    listen \"),n(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"80\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    server_name haiyong\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"site\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" #需要将haiyong\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"site替换成证书绑定的域名。\\n    rewrite \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"^\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"*\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"$ https\"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"$host$1\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" #将所有\"),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"HTTP\")]),t._v(\"请求通过rewrite指令重定向到\"),n(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"HTTPS\")]),t._v(\"。\\n    location \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        index index\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"html index\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"htm\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),n(\"p\",[t._v(\"复制\")]),t._v(\" \"),n(\"h4\",{attrs:{id:\"_5-重启-nginx-服务\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-重启-nginx-服务\"}},[t._v(\"#\")]),t._v(\" 5.重启 Nginx 服务\")])])}),[],!1,null,null,null);s.default=e.exports}}]);","extractedComments":[]}